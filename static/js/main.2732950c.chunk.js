(this["webpackJsonpwho-that-mask"]=this["webpackJsonpwho-that-mask"]||[]).push([[0],{22:function(e,t,n){e.exports={n898:"App_n898__24EbZ",flex_row:"App_flex_row__1Y8r1",flex_column:"App_flex_column__3fFxP",padded_header:"App_padded_header__18P3q"}},33:function(e,t,n){e.exports={outline:"Output_outline__30pg-",line:"Output_line__3suFW",grid:"Output_grid__2lwKT"}},83:function(e,t,n){},84:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(47),s=n.n(i),c=n(5),u=n(3),o=n(6),h=n(7),l=n(23),f=n(22),d=n.n(f),p=n(10),v=n(11),b=n(9),g=n(16),x=n(17),m=n(0),j=n(4),O=n(48),w=n.n(O),k=function(e,t){var n=w()(e,t);return Object(j.a)(Object(m.a)().mark((function e(){var t,r,a,i=this,s=arguments;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t=s.length,r=new Array(t),a=0;a<t;a++)r[a]=s[a];return e.next=3,new Promise((function(e,t){n.apply(i,r).then((function(t){e(t)})).catch((function(n){"canceled"!==n&&t(n),e(null)}))}));case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))},y=function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,new Promise((function(e){return setTimeout(e,t)}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),S=n(33),M=n.n(S),R=n(2),_=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(v.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){return e.canRender}},{key:"checkWidth",value:function(e){var t=this.props,n=t.id;(0,t.enqueueLineUpdate)(n,e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.cls,r=t.stl,a=this.props.line.map((function(e){var t=e.char;return" "===t?" ":t})).join("")+"\n";return Object(R.jsx)("div",{style:r,className:n,ref:function(t){if(t){var n=t.getBoundingClientRect().width;e.checkWidth(n)}},children:a})}}]),n}(r.Component),C=_,P=function(e,t,n){return new Map([].concat(Object(c.a)(e),[[t,n]]))},A=function(e,t,n){return e.map((function(e,r){return r===t?n:e}))};function L(e){this.name="TextException",this.message=e}var E=function(){return{numRenders:0,elWidthDiff:0,elWidth:0,line:arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]}},N=function(e){return Object(c.a)(Array(e).keys()).map((function(){return E([])}))},T=function(e){return e.line.slice(-1)[0]},W=function(e,t,n){return t&&0!==n&&!e.has(t)?P(e,t,Math.abs(n)):e},I=function(){return Math.round(Math.max.apply(Math,arguments))},D=function(){return Math.round(Math.min.apply(Math,arguments))},U=function(){return Math.floor(Math.min.apply(Math,arguments))},B=function(e,t){return Math.floor(e)===Math.floor(t)},H=function(e){return{widthRatio:e.elWidth/e.width,heightRatio:e.lineIdx/e.maxLines}},z=function(e,t){return e[t%e.length]},F=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;Object(p.a)(this,n);var a=(r=t.call(this,e)).props.readMaskShape(),i=Object(o.a)(a,2),s=i[0],c=i[1],u=window,h=u.innerWidth,l=u.innerHeight,f=Math.floor(950*s/c),d=U(950,l),v=N(Math.floor(d/16));return r.state={lines:v,fontSize:16,lineHeight:16,idealWidth:f,idealHeight:950,maxWidth:Math.floor(h),maxHeight:Math.floor(l),canRender:!0,widthMap:new Map},r.updateShape=k(r.updateShape,333).bind(Object(b.a)(r)),r.resetLines=k(r.resetLines,333).bind(Object(b.a)(r)),r.enqueueLineUpdate=r.enqueueLineUpdate.bind(Object(b.a)(r)),r.addCharsToLine=r.addCharsToLine.bind(Object(b.a)(r)),r.addCharToLine=r.addCharToLine.bind(Object(b.a)(r)),r.lineQueue=Promise.resolve(!0),r}return Object(v.a)(n,[{key:"getShape",value:function(){var e=this.props.readMaskShape(),t=Object(o.a)(e,2),n=t[0],r=t[1],a=this.state,i=a.idealWidth,s=a.idealHeight,c=this.state,h=c.maxWidth,l=c.maxHeight,f={width:U(i,h),height:U(s,l)},d=Math.floor(f.height*n/r),p=Math.floor(f.width*r/n);return d<f.width?Object(u.a)(Object(u.a)({},f),{},{width:d}):p<f.height?Object(u.a)(Object(u.a)({},f),{},{height:p}):f}},{key:"getMaxLines",value:function(){var e=this.state.lineHeight,t=this.getShape().height;return Math.floor(t/e)}},{key:"newLine",value:function(){return E(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[])}},{key:"newChar",value:function(e){var t=e.offset,n=void 0===t?-1:t,r=e.char,a=void 0===r?"?":r,i=e.art;return{offset:n,char:a,art:void 0!==i&&i}}},{key:"getLabel",value:function(){return this.props.label||"?"}},{key:"getNextOffsetByColumn",value:function(e,t){var n=e.elWidth,r=this.getShape().width,a=this.state.widthMap,i=this.getLabel(),s=Object(c.a)(Array(r).keys()).reduce((function(e,t){var r=e.done,s=e.prior,c=e.sumWidth,u=a.get(z(i,t))||0;return r||c+u>n+u/2?{done:!0,prior:s,sumWidth:c}:{prior:t,done:!1,sumWidth:c+u}}),{prior:-1,sumWidth:0,done:!1}),u=s.prior;return Math.max(u+t,0)}},{key:"getNextOffset",value:function(e,t){var n=(T(e)||{offset:-1}).offset;return Math.max(n+t,0)}},{key:"getNextChar",value:function(e,t){var n=this,r=this.props.alignment,a=this.getLabel(),i=function(){if("column"===r&&t>0&&!0===(T(e)||{}).art)return n.getNextOffsetByColumn(e,t);return n.getNextOffset(e,t)}(),s=z(a,i);return this.newChar({offset:i,char:s,art:!1})}},{key:"getLastLine",value:function(e){return e.slice(-1)[0]||this.newLine()}},{key:"getRatios",value:function(e,t){var n=this.getMaxLines(),r=this.getShape().width;return H({elWidth:e,width:r,lineIdx:t,maxLines:n})}},{key:"checkRatios",value:function(e,t){var n=this.getRatios(e,t),r=n.widthRatio,a=n.heightRatio;return!(r>1||a>1)}},{key:"getArtCharWidths",value:function(e,t){var n=this,r=this.props.artKernels;try{return new Map(Object.keys(r).map((function(r){var a=e.get(r)||0,i=n.getRatios(a,0).widthRatio*t;if(!i)throw new L("Unknown char width");return[r,{w:I(1,i)}]})))}catch(a){return console.error(a),new Map([])}}},{key:"getArtCharBounder",value:function(){var e=this.state.widthMap,t=this.props.readMaskShape,n=this.getShape().width,r=this.getMaxLines(),a=t(),i=Object(o.a)(a,2),s=i[0],c=i[1],h=this.getRatios(0,1).heightRatio,l=Math.max(1,Math.floor(h*c)),f=this.getArtCharWidths(e,s);return function(e,t){return function(e){var t=e.artWidthMap,n=e.h,r=e.width,a=e.maxLines,i=e.elWidth,s=e.lineIdx,c=e.maskWidth,u=e.maskHeight,o=H({elWidth:i,width:r,lineIdx:s,maxLines:a}),h=o.widthRatio,l=o.heightRatio;return{x:D(h*c,c-1),y:D(l*u,u-1),h:n,artWidthMap:t}}(Object(u.a)(Object(u.a)(Object(u.a)(Object(u.a)({},{width:n,maxLines:r}),{maskWidth:s,maskHeight:c}),{artWidthMap:f,h:l}),{elWidth:e,lineIdx:t}))}}},{key:"readMask",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n,r,a,i,s,c,u,o,h,l,f;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.props.readMaskPixel,r=this.props.readArtPixel,a=t.lineState,i=t.lineIdx,s=a.elWidth,this.checkRatios(s,i)){e.next=6;break}return e.abrupt("return",null);case 6:if(c=t.artCharBounder(s,i),u=c.x,o=c.y,h=c.h,l=c.artWidthMap,!n(u,o)){e.next=12;break}return e.next=10,r(l,h,u,o);case 10:return f=e.sent,e.abrupt("return",this.newChar({offset:this.getNextOffset(a,0),char:f,art:!0}));case 12:return e.abrupt("return",this.getNextChar(a,1));case 13:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"addCharToLine",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n){var r,a,i,s,c,o,h,l,f,d,p;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.done){e.next=2;break}return e.abrupt("return",t);case 2:if(r=t.lineState,!((a=t.hiddenChars).length>0&&r.line.length>0)){e.next=5;break}return e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{done:!0,lineState:Object(u.a)(Object(u.a)({},r),{},{line:r.line.concat([a.slice(-1)[0]])}),hiddenChars:a.slice(0,-1)}));case 5:return e.next=7,this.readMask(t);case 7:if(null!==(i=e.sent)){e.next=10;break}return e.abrupt("return",t);case 10:if(s=i.char,c=t.lineIdx,o=t.iMax,h=r.elWidth,l=this.state.widthMap,f=l.get(s)||0,d=h+f,this.checkRatios(d,c)){e.next=19;break}return e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{done:!0}));case 19:return p=[n===o,f<1].some((function(e){return e})),e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{lineState:Object(u.a)(Object(u.a)({},r),{},{line:r.line.concat([i]),elWidth:p?h:d}),done:p}));case 21:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"addCharsToLine",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n,r){var a,i,s,o,h,l=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.num,i=t.lines,s=t.hiddenChars,this.canLineRender(n)){e.next=3;break}return e.abrupt("return",t);case 3:return o=Object(c.a)(Array(a).keys()),e.next=6,o.reduce(function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=l,e.next=3,t;case 3:return e.t1=e.sent,e.t2=n,e.abrupt("return",e.t0.addCharToLine.call(e.t0,e.t1,e.t2));case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),Promise.resolve({iMax:a-1,done:!1,lineState:n,lineIdx:r,artCharBounder:t.artCharBounder,hiddenChars:s}));case 6:return h=e.sent,e.abrupt("return",Object(u.a)(Object(u.a)({},t),{},{allReady:!1,hiddenChars:h.hiddenChars,lines:A(i,r,h.lineState)}));case 8:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"listHiddenChars",value:function(){var e=this,t=this.props.artKernels,n=this.getLabel(),r=this.state.widthMap;return Object.keys(t).reduce((function(t,n){return r.has(n)?t:[e.newChar({char:n,offset:-1,art:!0})].concat(t)}),n.split("").reduce((function(t,n){return r.has(n)?t:[e.newChar({char:n,offset:-1,art:!1})].concat(t)}),[]))}},{key:"onColumnUpdate",value:function(){var e=this;return new Promise(function(){var t=Object(j.a)(Object(m.a)().mark((function t(n){var r,a;return Object(m.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.state.lines,t.next=3,r.reduce(function(){var t=Object(j.a)(Object(m.a)().mark((function t(n,r,a){return Object(m.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=e,t.next=3,n;case 3:return t.t1=t.sent,t.t2=r,t.t3=a,t.abrupt("return",t.t0.addCharsToLine.call(t.t0,t.t1,t.t2,t.t3));case 7:case"end":return t.stop()}}),t)})));return function(e,n,r){return t.apply(this,arguments)}}(),Promise.resolve({artCharBounder:e.getArtCharBounder(),hiddenChars:e.listHiddenChars(),allReady:!0,num:100,lines:r}));case 3:if(!(a=t.sent).allReady){t.next=6;break}return t.abrupt("return",e.setState({canRender:!1},n));case 6:return t.abrupt("return",e.setState({canRender:!0,lines:a.lines},n));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())}},{key:"updateLine",value:function(e,t){var n=this.getShape().width,r=e.numRenders,a=(T(e)||{offset:0}).offset;return t>n||a<0?Object(u.a)(Object(u.a)({},e),{},{line:e.line.slice(0,-1),elWidthDiff:e.elWidth-t}):Object(u.a)(Object(u.a)({},e),{},{elWidth:t,numRenders:r+1,elWidthDiff:t-e.elWidth})}},{key:"onLineUpdate",value:function(e,t){var n=this;return new Promise((function(r){var a=n.state,i=a.lines,s=a.widthMap;if(e<i.length){var c=(T(i[e])||{}).char,u=n.updateLine(i[e],t),o=u.elWidthDiff;n.setState({widthMap:W(s,c,o),lines:A(i,e,u),canRender:!1},r)}}))}},{key:"enqueueLineUpdate",value:function(e,t){var n=this;this.lineQueue.then(Object(j.a)(Object(m.a)().mark((function r(){return Object(m.a)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,n.onLineUpdate(e,t);case 2:return r.abrupt("return",r.sent);case 3:case"end":return r.stop()}}),r)}))))}},{key:"canLineRender",value:function(e){if(!e)return!1;var t=e.numRenders,n=e.elWidthDiff;return!(t>=2&&0===n)}},{key:"updateShape",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(){var t,n,r,a,i,s,c,u,o,h=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t={},n=this.getShape(),r=this.state,a=r.maxWidth,i=r.maxHeight,s=r.lineHeight,c=window,u=c.innerWidth,o=c.innerHeight,B(a,u)||(t.maxWidth=Math.floor(u)),B(i,o)||(t.maxHeight=Math.floor(o)),this.setState(t,Object(j.a)(Object(m.a)().mark((function e(){var t,r,a,i;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=h.getShape(),r=t.height,a=t.width,n.height!==r||n.width!==a){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,h.lineQueue;case 5:i=Math.floor(r/s),h.setState({canRender:!0,lines:N(i)});case 7:case"end":return e.stop()}}),e)}))));case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"resetLines",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(){var t,n,r,a,i,s,c=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.readMaskShape,n=this.state.idealHeight,r=t(),a=Object(o.a)(r,2),i=a[0],s=a[1],e.next=5,this.lineQueue;case 5:this.setState({canRender:!1,idealWidth:Math.floor(n*i/s)},(function(){var e=c.state.lineHeight,t=c.getShape().height,n=Math.floor(t/e);c.setState({canRender:!0,lines:N(n)})}));case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(){var t=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return window.addEventListener("resize",Object(j.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateShape();case 2:case"end":return e.stop()}}),e)})))),e.next=3,this.onColumnUpdate();case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.lineQueue;case 2:return e.next=4,this.onColumnUpdate();case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"shouldComponentUpdate",value:function(e,t){var n=this;return["label","artKernels","alignment"].map((function(t){return n.props[t]!==e[t]})).some((function(e){return!!e}))?(this.resetLines(),!1):t.canRender}},{key:"render",value:function(){var e=this,t=this.state.lines,n=this.state,r=n.fontSize,a=n.lineHeight,i=this.getShape(),s=i.width,c=i.height,u={fontSize:"".concat(r,"px"),lineHeight:"".concat(a,"px")},o={width:"".concat(s,"px"),height:"".concat(c,"px")},h=Object(R.jsx)("div",{style:u,className:M.a.outline,children:t.map((function(t,n){var r={top:n*a},i=t.line;return Object(R.jsx)(C,{enqueueLineUpdate:e.enqueueLineUpdate,canRender:e.canLineRender(t),stl:r,cls:M.a.line,line:i,id:n},n)}))});return Object(R.jsxs)("div",{className:M.a.grid,children:[Object(R.jsx)("div",{}),Object(R.jsx)("div",{style:o,children:h}),Object(R.jsx)("div",{})]})}}]),n}(r.Component),G=F,X=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).state={},r.missing=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0]],r.readMaskPixel=r.readMaskPixel.bind(Object(b.a)(r)),r.readMaskShape=r.readMaskShape.bind(Object(b.a)(r)),r}return Object(v.a)(n,[{key:"readMaskPixel",value:function(e,t){return!!this.missing[t][e]}},{key:"readMaskShape",value:function(){return[this.missing[0].length,this.missing.length]}},{key:"render",value:function(){var e=this.props.alignment;return Object(R.jsx)(G,{space:" ",stepSize:100,readMaskShape:this.readMaskShape,readMaskPixel:this.readMaskPixel,alignment:e,label:"Missing url! "})}}]),n}(r.Component),K=n(49),q=n(54);function V(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.name="SobelImageException",this.message=e,this.source=t}var Y=1e3,Q=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;return Object(p.a)(this,n),(r=t.call(this,e)).pos="a_pos",r.image_pos="a_image_pos",r.image_size="u_image_size",r.canvasRef=a.a.createRef(),r.state={program:null,buffer:null},r.initWebgl=k(r.initWebgl,10).bind(Object(b.a)(r)),r.readPixels=k(r.readPixels,10).bind(Object(b.a)(r)),r}return Object(v.a)(n,[{key:"initWebgl",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n,r,a,i,s,c=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&!(!t.height|!t.width)){e.next=3;break}throw new V(t?"Invalid image shape":"No image source",t);case 3:if(this.gl){e.next=5;break}throw new V("No webgl context","canvas");case 5:return this.gl.canvas.width=t.width,this.gl.canvas.height=t.height,this.gl.viewport(0,0,t.width,t.height),e.next=10,Promise.all([fetch(this.props.vertex).then((function(e){return e.text()})),fetch(this.props.fragment).then((function(e){return e.text()}))]);case 10:return n=e.sent,r=Object(o.a)(n,2),a=r[0],i=r[1],s=this.toProgram(new Map([["VERTEX_SHADER",a],["FRAGMENT_SHADER",i]])),e.next=17,new Promise((function(e){c.setState({buffer:c.initBuffers(s),program:s},e)}));case 17:return e.abrupt("return",e.sent);case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"toProgram",value:function(e){var t=this.gl,n=t.createProgram(),r=function(e,n,r){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",i=t["".concat(e,"_STATUS")],s=t["get".concat(n,"InfoLog")];if(!t["get".concat(n,"Parameter")].call(t,r,i))throw new V("".concat(s.call(t,r)),"".concat(e," ").concat(n," ").concat(a));return r};return e.forEach((function(e,a){var i=t.createShader(t[a]);t.shaderSource(i,e),t.compileShader(i),t.attachShader(n,i),r("COMPILE","Shader",i,a)})),t.linkProgram(n),r("LINK","Program",n)}},{key:"initBuffers",value:function(e){var t=this.gl;t.useProgram(e);var n=new Float32Array([-1,1,-1,-1,1,1,1,-1].concat([0,1,0,0,1,1,1,0])),r=t.getUniformLocation(e,this.image_size);return t.uniform2f(r,t.canvas.height,t.canvas.width),t.bindBuffer(t.ARRAY_BUFFER,t.createBuffer()),t.bufferData(t.ARRAY_BUFFER,n,t.STATIC_DRAW),n}},{key:"locateVertices",value:function(e,t){var n=this.gl,r=this.state.buffer.BYTES_PER_ELEMENT,a=[n.getAttribLocation(this.state.program,e),2,n.FLOAT,0,2*r,8*t*r];n.enableVertexAttribArray(a[0]),n.vertexAttribPointer.apply(n,a)}},{key:"drawWebgl",value:function(e){var t=this.gl;return this.locateVertices(this.pos,0),this.locateVertices(this.image_pos,1),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,t.createTexture()),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,1),this.tex={texImage2D:[t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE]},[[t.TEXTURE_2D,t.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE],[t.TEXTURE_2D,t.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE],[t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,this.gl.NEAREST],[t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,this.gl.NEAREST]].forEach((function(e){t.texParameteri.apply(t,Object(c.a)(e))})),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.drawArrays(t.TRIANGLE_STRIP,0,4),this.gl.canvas}},{key:"readPixels",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n,r,a){var i,s,c,u,o,h;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.gl,s=this.props.source,c=this.state,u=c.buffer,o=c.program,h=new Uint8Array(r*a*4),i){e.next=6;break}throw new V("No webgl context","canvas");case 6:if(s){e.next=8;break}throw new V("No image source","canvas");case 8:if(u&&o){e.next=10;break}throw new V("No webgl program","canvas");case 10:if(this.drawWebgl(s),i.readPixels(t,n,r,a,i.RGBA,i.UNSIGNED_BYTE,h),!h.every((function(e){return 0===e}))){e.next=14;break}throw new V("Empty webgl buffer","canvas");case 14:return e.abrupt("return",h);case 15:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"readAllPixels",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(){var t,n,r,a,i,s,c;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=1,t=this.gl.canvas,n=[0,0,t.width,t.height],r=n[0],a=n[1],i=n[2],s=n[3],e.next=6,this.readPixels(r,a,i,s);case 6:if(null!==(c=e.sent)){e.next=9;break}throw new V("canceled");case 9:return e.abrupt("return",{width:i,height:s,pixels:c});case 12:return e.prev=12,e.t0=e.catch(1),"canceled"!==e.t0.message&&console.error(e.t0),e.next=17,y(Y);case 17:e.next=0;break;case 19:case"end":return e.stop()}}),e,this,[[1,12]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidMount",value:function(){this.gl=this.canvasRef.current.getContext("webgl")}},{key:"componentDidUpdate",value:function(e){var t=this,n=this.props.source;!e.source&&n&&this.initWebgl(n).catch((function(e){if(e instanceof V)return t.setState({fatalError:!0}),console.error("".concat(e.source,":\n").concat(e.message));console.error(e)}))}},{key:"render",value:function(){return Object(R.jsx)("canvas",{id:"sobel-filter-canvas",ref:this.canvasRef})}}]),n}(r.Component),J=Q,Z=["","i","ii","iii","iv","v","vi","vii","viii","ix","x","xi","xii","xiii","xiv","xv","xvi","xvii","xviii","xix","xx","xxi"],$=function(e){var t=e.maxCenter,n=e.oldSize,r=e.newSize,a=e.weigh,i=function(e){var t=e%2===0;return{midFloor:Math.max(e-1*t,1),sideFloor:Math.max(e-1*!t,1)}}(Math.floor(r/n)),s=i.midFloor,u=i.sideFloor,o=(n-1)/2,h=(r-s)/2-o*u;if(!function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce((function(e,t){return!(!e||t%1!==0||t<0)}),!0)}(s-1,u-1,h))throw new ue("Cannot upsample from ".concat(n," to ").concat(r));var l=Object(c.a)(Array(o).keys()).sort((function(e,t){return Math.sign(a(t,o)-a(e,o))})),f=Object(c.a)(Array(n).keys()),d=Object(c.a)(Array(h).keys()).reduce((function(e,n){var r=l[n%o],a=e.rightCounts[r]+1;return t&&e.midCount<a&&e.remaining>=1&&(e.midCount+=2,e.remaining-=1),e.remaining>=1&&(e.leftCounts[o-1-r]=a,e.rightCounts[r]=a,e.remaining-=1),e}),{leftCounts:l.map((function(e){return u})),rightCounts:l.map((function(e){return u})),remaining:h,midCount:s}),p=d.leftCounts,v=d.midCount,b=d.rightCounts,g=[].concat(Object(c.a)(p),[v],Object(c.a)(b));return f.reduce((function(e,t){var n=e.final,r=e.countIdx,a=Object(c.a)(Array(g[r]).keys());return{final:n.concat(a.map((function(e){return t}))),countIdx:r+1}}),{final:[],countIdx:0}).final},ee=function(e,t,n){var r=Object(c.a)(Array(t).keys()),a=e.map((function(e){return function(e){var n=e.length;return{wideNear:$({maxCenter:!0,oldSize:n,newSize:t,weigh:function(e,t){return t-1-e}}),wideFar:$({maxCenter:!1,oldSize:n,newSize:t,weigh:function(e,t){return e}}),wideTween:$({maxCenter:!1,oldSize:n,newSize:t,weigh:function(e,t){return Math.min(e+.01,t-1-e)}})}}(e)}));return r.map((function(t){return r.map((function(n){var r;return function(e){var t=e.reduce((function(e,t){var n=1+(e.get(t)||0);return e.set(t,n)}),new Map([]));return Object(c.a)(t).reduce((function(e,n){var r=Object(o.a)(n,2),a=r[0],i=r[1],s=t.get(e)||0;return s===i?Math.max(a,e):i>s?a:e}),-1)}((r=[]).concat.apply(r,Object(c.a)(e.map((function(e,r){var i=a[r].wideTween[t],s=a[r].wideTween[n],c=a[r].wideNear[t],u=a[r].wideNear[n],o=a[r].wideFar[t],h=a[r].wideFar[n];return[e[o][h],e[c][u],e[i][s]]})))))}))}))},te=function(e,t){var n=e.slice(4*t,3+4*t),r=Object(o.a)(n,3),a=function(e,t,n){if(!(e<0||t<0||n<0||e>255||t>255||n>255)){e/=255,t/=255,n/=255;var r=Math.min(e,Math.min(t,n)),a=Math.max(e,Math.max(t,n));return r===a?[0,0,r]:[60*((e===r?3:n===r?1:5)-(e===r?t-n:n===r?e-t:n-e)/(a-r)),(a-r)/a,a]}alert("RGB values must be in the range 0 to 255.")}(r[0],r[1],r[2]),i=Object(o.a)(a,3),s=i[0],c=i[1];return i[2]<=1/255?0:c<=1/255?1:2+Math.floor(s%360/120)},ne=function(e,t){return e.reduce((function(e,n){var r=n[t],a=n.language.name;return a&&r&&e.set(a,r),e}),new Map([]))},re=function(e){var t=e.split("-").slice(-1)[0].toLowerCase();return Z.indexOf(t)||0},ae=function(){function e(t){var n;Object(p.a)(this,e);var r=t.name,a=t.id,i=t.names,s=t.genera,c=t.varieties;this.id=a,this.name=r,this.nameLangMap=ne(i,"name"),this.genusLangMap=ne(s,"genus"),this.hasGenderDiff=t.has_gender_differences||!1,this.hasGender=-1!==(t.gender_rate||0),this.generation=re((null===(n=t.generation)||void 0===n?void 0:n.name)||"");var u=c.reduce((function(e,t){var n=t.pokemon||{};return n.name&&(t.is_default&&(e.vDefault=n.name),e.vMap.set(n.name,{sprites:[]})),e}),{vDefault:null,vMap:new Map([])}),o=u.vMap,h=u.vDefault;this.varietyMap=o,this.varietyDefault=h}return Object(v.a)(e,[{key:"getName",value:function(e){return this.nameLangMap.get(e)||this.name}},{key:"getGenus",value:function(e){return this.genusLangMap.get(e)||null}},{key:"newSpriteList",value:function(e,t,n){var r=t.split("_"),a=Object(o.a)(r,2),i=a[0],s=a[1];return 2===r.length&&n?["shiny","gray"].includes(s)?[]:[Object(u.a)(Object(u.a)({},e),{},{gender:{default:this.hasGender?"male":"none"}[s]||s,canvas:null,side:i,url:n})]:[]}},{key:"parseSpriteData",value:function(e){var t=this;return Object.entries(e||{}).reduce((function(e,n){var r=Object(o.a)(n,2),a=r[0],i=r[1];return"other"===a?Object.entries(i||{}).reduce((function(e,n){var r=Object(o.a)(n,2),a=r[0],i=r[1];return Object.entries(i||{}).reduce((function(e,n){var r=Object(o.a)(n,2),i=r[0],s=r[1];return e.concat(t.newSpriteList({generation:{dream_world:5}[a]||t.generation,source:a},i,s))}),e)}),e):"versions"===a?Object.entries(i||{}).reduce((function(e,n){var r=Object(o.a)(n,2),a=r[0],i=r[1];return Object.entries(i||{}).reduce((function(e,n){var r=Object(o.a)(n,2),i=r[0],s=r[1];return Object.entries(s||{}).reduce((function(e,n){var r=Object(o.a)(n,2),s=r[0],c=r[1];return"icons"===i?e:e.concat(t.newSpriteList({generation:re(a),source:i},s,c))}),e)}),e)}),e):e.concat(t.newSpriteList({generation:0,source:"default"},a,i))}),[]).sort((function(){for(var e=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(){var r=e.slice(0,2).map((function(e){if(null===n)return e[t];var r=n.indexOf(e[t]);return-1!==r?r:n.length})),a=Object(o.a)(r,2);return a[0]-a[1]}},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var a=0,i=[e(n,"side",["front","back"]),e(n,"source",["official-artwork","dream_world","default"]),e(n,"generation",null),e(n,"gender",["none","female","male"])];a<i.length;a++){var s=(0,i[a])();if(0!==s)return s}return 0}))}},{key:"setSprites",value:function(e,t){return this.varietyMap=P(this.varietyMap,e,{sprites:t}),this.getSprites(e)}},{key:"setSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(n){var r=A(this.getSprites(e),t,n);this.setSprites(e,r)}return this.getSprite(e,t)}},{key:"getSprites",value:function(e){return(this.varietyMap.get(e)||{}).sprites||[]}},{key:"getSprite",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.getSprites(e)[t]||null}},{key:"loadSprite",value:function(e){var t=this;return new Promise((function(n,r){var a=t.getSprite(e,0)||{},i=a.url||"";i||r(new ue("No sprite url"));var s=new Image;s.crossOrigin="Anonymous",s.onload=Object(j.a)(Object(m.a)().mark((function e(){var t;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=document.createElement("canvas")).width=s.width,t.height=s.height,t.getContext("2d").drawImage(s,0,0),n(Object(u.a)(Object(u.a)({},a),{},{canvas:t}));case 5:case"end":return e.stop()}}),e)}))),s.onerror=function(){r(new ue("Invalid sprite url: ".concat(i)))},s.src=i}))}},{key:"readSpriteMaskPixel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0,a=(this.getSprite(e,t)||{}).canvas;if(!a)return!1;var i=(a.getContext("2d").getImageData(n,r,1,1)||{}).data;return!!i&&i[3]>=127}}]),e}(),ie=function(){return new ae({id:0,name:"",names:[{language:{name:"de"},name:"MissingNo."},{language:{name:"en"},name:"MissingNo."},{language:{name:"es"},name:"MissingNo."},{language:{name:"fr"},name:"MissingNo."},{language:{name:"it"},name:"MissingNo."},{language:{name:"ja"},name:"\u3051\u3064\u3070\u3093"},{language:{name:"ja-Hrkt"},name:"\u3051\u3064\u3070\u3093"},{language:{name:"ko"},name:"\ubbf8\uc2f1\ub178"},{language:{name:"roomaji"},name:"Ketsuban"},{language:{name:"zh-Hans"},name:"MissingNo."},{language:{name:"zh-Hant"},name:"MissingNo."}],genera:[],varieties:[],gender_rate:-1,generation:"i",has_gender_differences:!1})},se=function(e){var t=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=parseInt(e),isNaN(t)?n:Math.abs(t)}(e,NaN),n=0===t;if(0===e.length)throw new ce("No species name or dex number!");if(n)throw new ce("Invalid dex number!");return isNaN(t)?e.toLowerCase():t};function ce(e){this.name="DexException",this.message=e}function ue(e){this.name="SpriteException",this.message=e}var oe=function(e){Object(g.a)(n,e);var t=Object(x.a)(n);function n(e){var r;Object(p.a)(this,n),(r=t.call(this,e)).todoRef=a.a.createRef(),r.sobelRef=a.a.createRef();var i={" ":[[0,0,-1],[0,0,-1],[0,0,-1]],"|":[[1,1,-1],[1,1,-1],[1,1,-1]],"\xaf":[[2,2,2],[-1,-1,-1],[-1,-1,-1]],"\u2013":[[-1,-1,-1],[2,2,2],[-1,-1,-1]],_:[[-1,-1,-1],[-1,-1,-1],[2,2,2]],"\\":[[3,-1,-1],[3,3,-1],[3,3,-1]],"/":[[-1,4,-1],[4,4,-1],[4,4,-1]]},s={" ":[[0,0,0,-1,-1],[0,0,0,-1,-1],[0,0,0,-1,-1],[0,0,0,-1,-1],[0,0,0,-1,-1]],"|":[[1,1,1,-1,-1],[1,1,1,-1,-1],[1,1,1,-1,-1],[1,1,1,-1,-1],[1,1,1,-1,-1]],"\xaf":[[2,2,2,2,2],[2,2,2,2,2],[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1]],"\u2013":[[-1,-1,-1,-1,-1],[2,2,2,2,2],[2,2,2,2,2],[2,2,2,2,2],[-1,-1,-1,-1,-1]],_:[[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1],[2,2,2,2,2],[2,2,2,2,2]],"\\":[[3,3,-1,-1,-1],[3,3,-1,-1,-1],[3,3,3,-1,-1],[-1,3,3,-1,-1],[-1,3,3,3,-1]],"/":[[-1,4,4,4,-1],[-1,4,4,-1,-1],[4,4,4,-1,-1],[4,4,-1,-1,-1],[4,4,-1,-1,-1]]},u=Object.keys(i).reduce((function(e,t){return e[t]=new Map([[3,i[t]],[5,s[t]]]),e}),{}),o=[7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47,49,51,53,55,57,59,61].reduce((function(e,t){var n=function(n){var r=[e[n].get(3),e[n].get(5)];try{return ee(r,t)}catch(a){return console.error(a),null}};return Object.keys(e).reduce((function(e,r){return e[r].set(t,n(r)),e}),e)}),u);return r.state={lang:"en",artBuffer:{pixels:[],height:0,width:0},variety:null,spriteIndex:0,artKernels:o,maxArtKernel:Math.max.apply(Math,Object(c.a)(o[" "].keys())),pokemon:ie()},r.dex=new q.a,r.missing=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,0,0,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,1,1,1,1,1,0,0],[0,0,0,0,0,0,0,0,0]],r.readArtPixel=r.readArtPixel.bind(Object(b.a)(r)),r.readMaskPixel=r.readMaskPixel.bind(Object(b.a)(r)),r.readMaskShape=r.readMaskShape.bind(Object(b.a)(r)),r}return Object(v.a)(n,[{key:"componentDidMount",value:function(){this.ctx=this.todoRef.current.getContext("2d");var e=this.props.n,t=this.state,n=t.variety,r=t.spriteIndex;this.loadPokemon(e,n,r)}},{key:"componentDidUpdate",value:function(){var e=this.props.n,t=this.state,n=t.variety,r=t.spriteIndex;this.loadPokemon(e,n,r)}},{key:"isSameSpecies",value:function(e){var t,n=(t=e)instanceof ae?t.id:t;return this.spriteCall((function(e){var t=e.p;return[t.name,t.id].includes(n)}))}},{key:"isSameVariety",value:function(e,t){return!!this.isSameSpecies(e)&&this.spriteCall((function(e){return e.v===t}))}},{key:"isSameSprite",value:function(e,t,n){return!!this.isSameVariety(e,t)&&this.spriteCall((function(e){return e.s===n}))}},{key:"loadPokemonSpecies",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!!this.isSameSpecies(t)){e.next=9;break}return e.t1=ae,e.next=5,this.dex.getPokemonSpeciesByName(t);case 5:e.t2=e.sent,e.t0=new e.t1(e.t2),e.next=10;break;case 9:e.t0=this.spriteCall((function(e){return e.p}));case 10:return n=e.t0,e.abrupt("return",n);case 12:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadPokemonSprites",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isSameVariety(t,n)){e.next=2;break}return e.abrupt("return",t.getSprites(n));case 2:return e.t0=t,e.next=5,this.dex.getPokemonByName(n);case 5:if(e.t1=e.sent,e.t1){e.next=8;break}e.t1={};case 8:return e.t2=e.t1.sprites,e.abrupt("return",e.t0.parseSpriteData.call(e.t0,e.t2));case 10:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"loadPokemonSprite",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n,r){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isSameSprite(t,n,r)){e.next=2;break}return e.abrupt("return",t.getSprite(n,r));case 2:return e.next=4,t.loadSprite(n,r);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"loadPokemon",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n,r,a,i,s,c,u=this,o=arguments;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o.length>1&&void 0!==o[1]?o[1]:null,r=o.length>2&&void 0!==o[2]?o[2]:0,a=this.state.lang,e.next=5,Object(j.a)(Object(m.a)().mark((function e(){var n;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,n=se(t),e.next=4,u.loadPokemonSpecies(n);case 4:return e.abrupt("return",e.sent);case 7:return e.prev=7,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",ie());case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))();case 5:if(i=e.sent,s=[n,this.isSameSpecies(i)].every((function(e){return!!e})),c=s?n:i.varietyDefault||i.name,!this.isSameSprite(i,c,r)){e.next=11;break}return e.abrupt("return",!1);case 11:return e.t0=i,e.t1=c,e.next=15,Object(j.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.loadPokemonSprites(i,c);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",i.getSprites(c));case 11:case"end":return e.stop()}}),e,null,[[0,6]])})))();case 15:return e.t2=e.sent,e.t0.setSprites.call(e.t0,e.t1,e.t2),e.t3=i,e.t4=c,e.t5=r,e.next=22,Object(j.a)(Object(m.a)().mark((function e(){return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,u.loadPokemonSprite(i,c,r);case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",null);case 10:case"end":return e.stop()}}),e,null,[[0,6]])})))();case 22:return e.t6=e.sent,e.t3.setSprite.call(e.t3,e.t4,e.t5,e.t6),this.setState({spriteIndex:r,pokemon:i,variety:c}),this.props.setSpeciesName(i.getName(a)),this.props.setSpeciesIndex(i.id),e.abrupt("return",!0);case 28:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"spriteCall",value:function(e){var t=this.state;return e({p:t.pokemon,v:t.variety,s:t.spriteIndex})}},{key:"accessArtBuffer",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n,r,a,i,s,u,o,h,l=this;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.x,r=t.y,a=t.w,i=t.h,s=this.sobelRef.current,e.next=4,Object(j.a)(Object(m.a)().mark((function e(){var t;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(l.state.artBuffer.pixels.length>0)){e.next=2;break}return e.abrupt("return",l.state.artBuffer);case 2:return e.next=4,s.readAllPixels();case 4:return t=e.sent,e.next=7,new Promise((function(e){l.setState({artBuffer:t},e)}));case 7:return e.abrupt("return",t);case 8:case"end":return e.stop()}}),e)})))();case 4:return u=e.sent,o=Object(c.a)(Array(i).keys()),h=o.reduce((function(e,t){var i=(u.height-(r+t))*u.width+n,s=i+a;return e.concat([].slice.call(u.pixels,4*i,4*s))}),[]),e.abrupt("return",h);case 8:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"resizeArtPixelBounds",value:function(e){var t=e.x,n=e.y,r=e.w,a=e.h,i=t+r/2,s=n+a/2,c=Math.min(this.state.maxArtKernel,2*Math.floor(Math.max(a,r,3)/2)+1),o={h:c,w:c};return Object(u.a)(Object(u.a)({},o),{},{x:Math.round(Math.max(0,i-o.w/2)),y:Math.round(Math.max(0,s-o.h/2))})}},{key:"readArtPixelColumns",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t){var n,r,a,i,s,u;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.x,r=t.y,a=t.w,i=t.h,e.next=3,this.accessArtBuffer({x:n,y:r,w:a,h:i});case 3:return s=e.sent,u=Object(c.a)(Array(a*i).keys()),e.abrupt("return",Object(c.a)(u.reduce((function(e,t){var n=e.get(t%a)||[],r=te(s,t);return e.set(t%a,n.concat([r]))}),new Map([])).values()));case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"readArtPixel",value:function(){var e=Object(j.a)(Object(m.a)().mark((function e(t,n,r,a){var i,s,u,h,l,f,d,p,v,b,g,x;return Object(m.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.size){e.next=2;break}return e.abrupt("return","?");case 2:return i=this.state.artKernels,s=this.resizeArtPixelBounds({x:r,y:a,w:(m=t,Object(c.a)(m.values()).reduce((function(e,t){var n=t.w;return Math.max(e,n)}),1)),h:n}),e.next=6,this.readArtPixelColumns(s);case 6:return u=e.sent,h=Object(c.a)(u).reduce((function(e,n,r){return Object(c.a)(t).reduce((function(e,t){var a=Object(o.a)(t,2),s=a[0],c=(a[1].w,i[s].get(n.length));if(0===r){console.log(n.length);var u,h=Object(K.a)(c);try{for(h.s();!(u=h.n()).done;){var l=u.value;console.log(JSON.stringify(l))}}catch(d){h.e(d)}finally{h.f()}}var f=n.reduce((function(e,t,n){var a=e.n,i=e.t;return{n:a+(c[n][r]===t),t:i+(c[n][r]>=0)}}),e.get(s)||{n:0,t:0});return e.set(s,f)}),e)}),new Map([])),l=new Map(Object(c.a)(h).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1],a=r.n,i=r.t;return[n,a/Math.max(i,1)]}))),f={" ":1},4,d=s.h/4,p=Object.keys(i).reverse().reduce((function(e,t){var n=f[e]||d,r=f[t]||d;return(l.get(e)||0)*n<=(l.get(t)||0)*r?t:e}),""),v=Object(o.a)({"?":[255,0,255]," ":[0,0,0],"|":[255,255,255],"\xaf":[255,0,0],"\u2013":[255,0,0],_:[255,0,0],"\\":[0,255,0],"/":[0,0,255]}[p||"?"],3),b=v[0],g=v[1],x=v[2],this.ctx.clearRect(s.x,s.y,s.w,s.h),this.ctx.fillStyle="rgba("+b+","+g+","+x+",1)",this.ctx.fillRect(s.x,s.y,s.w,s.h),this.ctx.fillStyle="rgba(0,0,0,1)",this.ctx.fillRect(s.x+1,s.y+1,s.w-2,s.h-2),e.next=21,y(5);case 21:if(p.length){e.next=23;break}return e.abrupt("return","?");case 23:return e.abrupt("return",p);case 24:case"end":return e.stop()}var m}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"readMaskPixel",value:function(e,t){return this.spriteCall((function(e){var t=e.p,n=e.v,r=e.s;return t.getSprite(n,r)||{}})).canvas?this.spriteCall((function(n){var r=n.p,a=n.v,i=n.s;return r.readSpriteMaskPixel(a,i,e,t)})):!!this.missing[t][e]}},{key:"readMaskShape",value:function(){var e=this.spriteCall((function(e){var t=e.p,n=e.v,r=e.s;return t.getSprite(n,r)||{}})).canvas;return e?[e.width,e.height]:[this.missing[0].length,this.missing.length]}},{key:"render",value:function(){var e=this.props.alignment,t=this.state,n=t.lang,r=t.artKernels,a=this.spriteCall((function(e){return e.p.getName(n)||"DEX ERR "})),i=Object(R.jsx)(G,{readMaskShape:this.readMaskShape,readMaskPixel:this.readMaskPixel,readArtPixel:this.readArtPixel,label:a.toLocaleLowerCase("en-US"),artKernels:r,alignment:e}),s=this.spriteCall((function(e){var t=e.p,n=e.v,r=e.s;return t.getSprite(n,r)||{}})),c=s.url,u=s.canvas,o=(null===u||void 0===u?void 0:u.width)||100,h=(null===u||void 0===u?void 0:u.height)||100;return this.ctx&&this.ctx.clearRect(0,0,o,h),Object(R.jsxs)("div",{children:[i,Object(R.jsx)("a",{href:c||"/",children:Object(R.jsx)(J,{ref:this.sobelRef,source:u,vertex:"/vertex.glsl",fragment:"/fragment.glsl"})}),Object(R.jsx)("canvas",{width:o,height:h,id:"todo-remove",ref:this.todoRef})]})}}]),n}(r.Component),he=oe,le=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return[null,""].includes(e)?t:e},fe=function(e){var t=new URLSearchParams(Object(h.f)().search);return Object.entries(e).reduce((function(e,n){var r=Object(o.a)(n,2),a=r[0],i=(0,r[1])(t.get(a));return null!==i&&(e[a]=i),e}),{})},de=function(e){return function(e){var t={row:function(e){return function(e){return null==e?arguments.length>1&&void 0!==arguments[1]&&arguments[1]:!(arguments.length>2&&void 0!==arguments[2])||arguments[2]}(e,"column","row")}};return"dex"===e.slug[0]?{navigation:"dex",parsers:Object(u.a)(Object(u.a)({},t),{},{n:le})}:{navigation:"home",parsers:Object(u.a)(Object(u.a)({},t),{},{url:function(e){return le(e)}})}}(e)},pe=function(e){return"/dex?n=".concat(e)};function ve(e){var t=1e3,n=Object(r.useState)(NaN),a=Object(o.a)(n,2),i=a[0],s=a[1],u=Object(r.useState)("Loading..."),h=Object(o.a)(u,2),f=h[0],p=h[1],v=de(e);v.query=fe(v.parsers);var b=function(e){var n=e.navigation;e.query;if("dex"===n){var r=isNaN(i),a=r?"#???":"#".concat(i),s=r?1:Math.max(1,(i+1)%1001),c=pe(s);return Object(R.jsxs)("div",{className:d.a.flex_row,children:[Object(R.jsx)("span",{children:Object(R.jsx)(l.b,{to:"/",children:"Home"})}),Object(R.jsx)("span",{children:Object(R.jsxs)("strong",{children:[a," ",f]})}),Object(R.jsxs)("span",{children:["Next:  ",Object(R.jsxs)(l.b,{to:c,children:["#",s]})]})]})}var u=Math.ceil(Math.random()*t),o=pe(u);return Object(R.jsx)("div",{className:d.a.flex_row,children:Object(R.jsxs)("div",{className:d.a.padded_header,children:["Try this Pok\xe9mon: ",Object(R.jsxs)(l.b,{to:o,children:["#",u]})]})})}(v),g=function(e){var n=e.query,r=e.navigation,a=n.row;if("dex"===r){var i=n.n;return Object(R.jsx)(he,{alignment:a,setSpeciesIndex:s,setSpeciesName:p,n:i||""})}var u=n.url;return u?Object(R.jsx)(X,{alignment:a,url:u||""}):Object(R.jsx)("div",{className:d.a.n898,children:Object(R.jsx)("div",{className:d.a.flex_column,children:Object(c.a)(Array(t).keys()).map((function(e){var t=e+1,n=pe(t);return Object(R.jsx)("div",{children:Object(R.jsxs)(l.b,{to:n,children:["Dex #",t]})},t)}))})})}(v);return Object(R.jsxs)("div",{children:[Object(R.jsx)("div",{children:b}),Object(R.jsx)("div",{children:g})]})}var be=function(){return Object(R.jsx)(l.a,{basename:"",children:Object(R.jsx)("div",{className:"App",children:Object(R.jsxs)(h.c,{children:[Object(R.jsx)(h.a,{path:"/dex",children:Object(R.jsx)(ve,{slug:["dex"]})}),Object(R.jsx)(h.a,{path:"/",children:Object(R.jsx)(ve,{slug:[]})})]})})})};n(83);s.a.render(Object(R.jsx)(a.a.StrictMode,{children:Object(R.jsx)(be,{})}),document.getElementById("root"))}},[[84,1,2]]]);
//# sourceMappingURL=main.2732950c.chunk.js.map